{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import'./TherapyChat.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TherapyChat=()=>{const[messages,setMessages]=useState([]);const[inputText,setInputText]=useState('');const[isLoading,setIsLoading]=useState(false);const messagesEndRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};useEffect(()=>{scrollToBottom();},[messages]);const handleSubmit=async e=>{e.preventDefault();if(!inputText.trim())return;// 添加用户消息\nconst userMessage={text:inputText,sender:'user',timestamp:new Date().toLocaleTimeString()};setMessages(prev=>[...prev,userMessage]);setInputText('');setIsLoading(true);try{const response=await fetch('/api/therapy-chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:inputText})});const data=await response.json();// 添加机器人回复\nconst botMessage={text:data.response,sender:'bot',timestamp:new Date().toLocaleTimeString()};setMessages(prev=>[...prev,botMessage]);}catch(error){console.error('Error:',error);}finally{setIsLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"therapy-chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u5FC3\\u7406\\u54A8\\u8BE2\\u52A9\\u624B\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u968F\\u65F6\\u503E\\u542C\\uFF0C\\u4E3A\\u60A8\\u89E3\\u5FE7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"messages\",children:[messages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"message \".concat(message.sender),children:/*#__PURE__*/_jsxs(\"div\",{className:\"message-content\",children:[/*#__PURE__*/_jsx(\"p\",{children:message.text}),/*#__PURE__*/_jsx(\"span\",{className:\"timestamp\",children:message.timestamp})]})},index)),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"message bot\",children:/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u6B63\\u5728\\u601D\\u8003...\"})})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"input-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:inputText,onChange:e=>setInputText(e.target.value),placeholder:\"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u95EE\\u9898...\",disabled:isLoading}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isLoading,children:\"\\u53D1\\u9001\"})]})]})]});};export default TherapyChat;","map":{"version":3,"names":["React","useState","useRef","useEffect","jsx","_jsx","jsxs","_jsxs","TherapyChat","messages","setMessages","inputText","setInputText","isLoading","setIsLoading","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSubmit","e","preventDefault","trim","userMessage","text","sender","timestamp","Date","toLocaleTimeString","prev","response","fetch","method","headers","body","JSON","stringify","message","data","json","botMessage","error","console","className","children","map","index","concat","ref","onSubmit","type","value","onChange","target","placeholder","disabled"],"sources":["/Users/qiwei/Desktop/Desktop - Qiwei’s MacBook Pro M1/Job/AI Project/personal-website-1/frontend/src/components/TherapyChat.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport './TherapyChat.css';\n\nconst TherapyChat = () => {\n  const [messages, setMessages] = useState([]);\n  const [inputText, setInputText] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!inputText.trim()) return;\n\n    // 添加用户消息\n    const userMessage = {\n      text: inputText,\n      sender: 'user',\n      timestamp: new Date().toLocaleTimeString()\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputText('');\n    setIsLoading(true);\n\n    try {\n      const response = await fetch('/api/therapy-chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ message: inputText })\n      });\n\n      const data = await response.json();\n      \n      // 添加机器人回复\n      const botMessage = {\n        text: data.response,\n        sender: 'bot',\n        timestamp: new Date().toLocaleTimeString()\n      };\n      setMessages(prev => [...prev, botMessage]);\n    } catch (error) {\n      console.error('Error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"therapy-chat\">\n      <div className=\"chat-header\">\n        <h1>心理咨询助手</h1>\n        <p>随时倾听，为您解忧</p>\n      </div>\n\n      <div className=\"chat-container\">\n        <div className=\"messages\">\n          {messages.map((message, index) => (\n            <div key={index} className={`message ${message.sender}`}>\n              <div className=\"message-content\">\n                <p>{message.text}</p>\n                <span className=\"timestamp\">{message.timestamp}</span>\n              </div>\n            </div>\n          ))}\n          {isLoading && (\n            <div className=\"message bot\">\n              <div className=\"message-content\">\n                <p>正在思考...</p>\n              </div>\n            </div>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"input-form\">\n          <input\n            type=\"text\"\n            value={inputText}\n            onChange={(e) => setInputText(e.target.value)}\n            placeholder=\"请输入您的问题...\"\n            disabled={isLoading}\n          />\n          <button type=\"submit\" disabled={isLoading}>\n            发送\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default TherapyChat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}